<div class="same-width-box">
  <div class="progress-wrapper">
    <mat-progress-bar
      mode="determinate"
      [value]="progressValue"
      color="primary"
      class="progress-bar"
    ></mat-progress-bar>

    <div class="steps-container">
      <div
        *ngFor="let step of steps; let i = index"
        class="step-circle"
        [class.active]="i <= currentStep"
        [style.left.%]="(i / (steps.length - 1)) * 100"
      >
        {{ i + 1 }}
      </div>
    </div>

    <div class="step-labels">
      <ng-container *ngFor="let step of steps; let i = index">
        <div
          *ngIf="i < steps.length - 1"
          class="step-label"
          [style.left.%]="((i + 0.5) / (steps.length - 1)) * 100"
        >
          {{ step.label }}
        </div>
      </ng-container>
    </div>
  </div>
</div>

<div class="course-form-container mat-elevation-z4">
  <h2 class="form-title mat-primary">Student Profile</h2><br />

  <mat-form-field appearance="outline" class="form-group colorful-dropdown">
    <mat-label>Enrollment Type</mat-label>
    <mat-select [(value)]="enrollmentType" (selectionChange)="onEnrollmentTypeChange($event.value)">
      <mat-option value="trial">
        <span class="dropdown-option trial-option">Trial Student</span>
      </mat-option>
      <mat-option value="direct">
        <span class="dropdown-option direct-option">Direct Enrollment</span>
      </mat-option>
    </mat-select>

    <div *ngIf="enrollmentType === 'trial'" class="trial-list-button" style="margin-top:10px;">
      <button mat-raised-button color="primary" (click)="goToTrialStudentList()">
        View All Trial Students
      </button>
    </div>
  </mat-form-field>

  <form [formGroup]="ProfileForm" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <mat-form-field appearance="outline" class="form-group">
        <mat-label>First Name</mat-label>
        <input matInput type="text" formControlName="firstName" placeholder="Enter First Name" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-group">
        <mat-label>Last Name</mat-label>
        <input matInput type="text" formControlName="lastName" placeholder="Enter Last Name" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-group">
        <mat-label>Address</mat-label>
        <input matInput type="text" formControlName="address" placeholder="Enter address" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-group">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" placeholder="Enter email" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-group">
        <mat-label>Phone</mat-label>
        <input matInput formControlName="phone" placeholder="Enter phone" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-group">
        <mat-label>Date of Birth</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          formControlName="dob"
          placeholder="Choose a date"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>

        <mat-error *ngIf="ProfileForm.get('dob')?.hasError('required')">
          Date of Birth is required
        </mat-error>
        <mat-error *ngIf="ProfileForm.get('dob')?.hasError('minAge')">
          Student must be at least 16 years old
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="form-group">
        <mat-label>Referred By</mat-label>
        <mat-select formControlName="referredBy" required>
          <mat-option *ngFor="let key of referenceOptions" [value]="key">
            {{ referenceLabels[key] }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="btn-wrapper">
        <button mat-raised-button color="primary" type="submit">Next</button>
      </div>
    </div>
  </form>
</div>
